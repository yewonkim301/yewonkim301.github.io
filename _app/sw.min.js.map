{"version":3,"file":"sw.min.js","sources":["../_javascript/pwa/sw.js"],"sourcesContent":["import { baseurl } from '../../_config.yml';\n\nimportScripts(`${baseurl}/assets/js/data/swconf.js`);\n\nconst purge = swconf.purge;\n\nfunction verifyUrl(url) {\n  const requestPath = new URL(url).pathname;\n\n  for (const path of swconf.denyPaths) {\n    if (requestPath.startsWith(path)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nself.addEventListener('install', (event) => {\n  if (purge) {\n    return;\n  }\n\n  event.waitUntil(\n    caches.open(swconf.cacheName).then((cache) => {\n      return cache.addAll(swconf.resources);\n    })\n  );\n});\n\nself.addEventListener('activate', (event) => {\n  event.waitUntil(\n    caches.keys().then((keyList) => {\n      return Promise.all(\n        keyList.map((key) => {\n          if (purge) {\n            return caches.delete(key);\n          } else {\n            if (key !== swconf.cacheName) {\n              return caches.delete(key);\n            }\n          }\n        })\n      );\n    })\n  );\n});\n\nself.addEventListener('message', (event) => {\n  if (event.data === 'SKIP_WAITING') {\n    self.skipWaiting();\n  }\n});\n\nself.addEventListener('fetch', (event) => {\n  if (event.request.headers.has('range')) {\n    return;\n  }\n\n  event.respondWith(\n    caches.match(event.request).then((response) => {\n      if (response) {\n        return response;\n      }\n\n      return fetch(event.request).then((response) => {\n        const url = event.request.url;\n\n        if (purge || event.request.method !== 'GET' || !verifyUrl(url)) {\n          return response;\n        }\n\n        // See: <https://developers.google.com/web/fundamentals/primers/service-workers#cache_and_return_requests>\n        let responseToCache = response.clone();\n\n        caches.open(swconf.cacheName).then((cache) => {\n          cache.put(event.request, responseToCache);\n        });\n        return response;\n      });\n    })\n  );\n});\n"],"names":["importScripts","concat","baseurl","purge","swconf","verifyUrl","url","requestPath","URL","pathname","path","denyPaths","startsWith","self","addEventListener","event","waitUntil","caches","open","cacheName","then","cache","addAll","resources","keys","keyList","Promise","all","map","key","delete","data","skipWaiting","request","headers","has","respondWith","match","response","fetch","method","responseToCache","clone","put"],"mappings":"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"}