---
title: "[Spring] 헬스체크란?"
date: 2025-08-27
categories: [Spring]
tags: [TIL, Spring]
---


# # 헬스 체크란?

헬스 체크(Health Check)는 현재 서버의 상태가 정상인지 파악하는 것을 의미한다.

서버가 정상적으로 작동하고 있는지, 필요한 서비스들이 제대로 실행되고 있는지 등을 확인하는 과정이다. 

<br /><br />

## # 헬스 체크가 필요한 이유

헬스 체크는 **시스템의 안정성과 가용성을 유지**하는 데 중요한 역할을 한다.

1. **장애 감지** : 헬스 체크를 통해 시스템의 장애를 조기에 감지할 수 있다. 문제가 발생했을 때 빠르게 대응할 수 있어 서비스 중단 시간을 최소화할 수 있다.

2. **자동 복구** : 헬스 체크 결과를 기반으로 자동 복구 메커니즘을 구현할 수 있다. 예를 들어, 특정 서비스가 비정상 상태로 감지되면 자동으로 재시작하거나 대체 서버로 트래픽을 전환할 수 있다.

3. **로드 밸런싱** : 헬스 체크는 로드 밸런서가 정상적인 서버에만 트래픽을 분배하도록 도와준다. 비정상 상태인 서버로의 요청을 차단하여 전체 시스템의 안정성을 높일 수 있다.

   **예를 들어서,**

      1) 서버 한 대가 서비스 불가 상태인 경우
      ![img](/assets/img/til/cs/헬스체크1.png)

      2) 대량의 트래픽이 들어올 것을 대비하는 등등의 이유로 서버를 증설해야 하는데 해당 서버가 관련된 소스코드를 로딩하고 있는 경우
      ![img](/assets/img/til/cs/헬스체크1.png)

   이러한 경우, 정상적인 서비스가 불가능해서 클라이언트의 요청을 수행할 수 없기 때문에 해당 서버로 요청을 보내면 안된다. 보낼시 장애를 유발하거나 해당 서버의 부하를 크게 증가시켜 오히려 장애를 더 심각하게 만들 수 있다.

   이처럼 헬스 체크는 정상적으로 서비스가 가능한 서버에만 트래픽을 보내서 **서비스의 고가용성을 확보**하는 데 도움이 된다.

<br /><br />

## # Spring Boot Actuator의 헬스 체크

`Spring Boot Actuator`를 의존성으로 추가하면 기본적으로 헬스 체크 엔드포인트가 활성화된다.

Spring Boot 3.x 기준으로 헬스 체크 엔드포인트는 기본적으로 `/actuator/health` 경로로 제공된다.

이 엔드포인트에 접근하면 애플리케이션의 상태를 JSON 형식으로 확인할 수 있다.

```json
{
  "status": "UP"
}
```

- `status` 필드는 애플리케이션의 현재 상태를 나타낸다.
  - `UP` : 애플리케이션이 정상적으로 작동 중임을 나타낸다.
  - `DOWN` : 애플리케이션이 비정상 상태임을 나타낸다.
  - `OUT_OF_SERVICE` : 애플리케이션이 서비스 불가 상태임을 나타낸다.
  - `UNKNOWN` : 애플리케이션 상태를 알 수 없음을 나타낸다.

<br />

### # 커스텀 헬스 체크

Spring Boot Actuator는 기본적인 헬스 체크 외에도 커스텀 헬스 체크를 구현할 수 있는 기능을 제공한다 커스텀 헬스 인디케이터를 추가하면 특정 서비스나 컴포넌트의 상태를 체크할 수 있다.

커스텀 헬스 체크를 구현하려면 `HealthIndicator` 인터페이스를 구현하면 된다.

```java
import org.springframework.boot.actuate.health.Health;
import org.springframework.boot.actuate.health.HealthIndicator;
import org.springframework.stereotype.Component;

@Component
public class CustomHealthIndicator implements HealthIndicator {
   
    @Override
    public Health health() {
        // 커스텀 헬스 체크 로직 구현
        boolean isHealthy = checkSomeService();

        if (isHealthy) {
            return Health.up().withDetail("Custom Service", "Available").build();
        } else {
            return Health.down().withDetail("Custom Service", "Unavailable").build();
        }
    }

    private boolean checkSomeService() {
        // 실제 서비스 상태를 확인하는 로직 구현
        return true; // 예시로 항상 정상 상태를 반환
    }
}
```

위 예제에서 `CustomHealthIndicator` 클래스는 `HealthIndicator` 인터페이스를 구현하여 커스텀 헬스 체크 로직을 정의한다.

이렇게 구현된 커스텀 헬스 체크는 `/actuator/health` 엔드포인트에서 기본 헬스 체크와 함께 제공된다.


<br /><br />

참고 : 
- [헬스체크에 대해서 설명해 주세요.](https://www.maeil-mail.kr/question/311)
- [Spring Boot Actuator의 헬스체크 살펴보기](https://toss.tech/article/how-to-work-health-check-in-spring-boot-actuator)
