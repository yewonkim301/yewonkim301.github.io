---
title: "[CS] Event Sourcing 이란?"
date: 2025-08-15
categories: [CS]
tags: [TIL, CS, DATA]
---

# # Event Sourcing 이란?

**이벤트 소싱(Event Sourcing)**은 시스템의 상태를 이벤트(상태 변화)를 통해 저장하고 관리하는 데이터 저장 방법이다. 데이터의 최종 상태를 직접 저장하는 것이 아니라, 상태 변화의 기록을 저장하는 방법이다.

<br / ><br />

### # 이벤트 소싱 예시

이벤트 소싱은 다양한 분야에서 활용될 수 있다. 예를 들어, 금융 시스템, 주문 처리 시스템, 사용자 활동 로그 등에서 사용된다.
<br />

예를 들어, 쇼핑몰 시스템에서 주문을 처리하는 경우를 생각해보자.
1. **주문 생성 이벤트** : 사용자가 주문을 생성하면, "주문 생성" 이벤트가 발생하고 해당 이벤트가 이벤트 스토어에 저장된다.

2. **주문 상태 변경 이벤트** : 주문이 결제되거나 배송되면, 각각 "주문 결제" 이벤트와 "주문 배송" 이벤트가 발생하고 저장된다.

3. **주문 취소 이벤트** : 사용자가 주문을 취소하면, "주문 취소" 이벤트가 발생하고 저장된다.

4. **상태 재구성** : 특정 시점의 주문 상태를 알고 싶다면, 해당 시점까지의 이벤트를 순차적으로 적용하여 현재 상태를 재구성할 수 있다.

<br /><br />

### # 이벤트 소싱의 특징

1. **상태 변화 기록**: 시스템의 상태가 변경될 때마다 해당 변경 사항을 이벤트로 기록한다. 예를 들어, 주문 생성, 주문 취소 등의 이벤트가 발생할 때마다 해당 이벤트를 저장한다.

2. **불변성**: 이벤트는 불변(immutable)으로 저장된다. 즉, 한 번 저장된 이벤트는 수정되지 않으며, 새로운 이벤트가 추가되어 상태를 변경한다.

3. **재구성 가능성**: 시스템의 현재 상태를 이벤트 로그를 통해 재구성할 수 있다. 이벤트 로그를 순차적으로 적용하여 현재 상태를 복원할 수 있다.

4. **이벤트 스토어**: 이벤트를 저장하는 데이터베이스를 이벤트 스토어라고 하며, 이벤트 소싱에서는 이 이벤트 스토어가 핵심 역할을 한다.

<br /><br />

### # 이벤트 소싱의 장점

1. **이력 관리**: 모든 상태 변화가 이벤트로 기록되므로, 시스템의 이력을 쉽게 추적할 수 있다. 이는 디버깅이나 감사(audit) 목적으로 유용하다.

2. **복원 가능성**: 이벤트 로그를 통해 시스템의 상태를 특정 시점으로 되돌릴 수 있다. 이는 시스템 장애나 데이터 손실 시 유용하다.

3. **확장성**: 이벤트 소싱은 시스템의 상태를 이벤트로 표현하므로, 새로운 기능이나 변경 사항을 추가할 때 유연하게 대응할 수 있다.

4. **CQRS와의 통합**: 이벤트 소싱은 CQRS(Command Query Responsibility Segregation) 패턴과 잘 어울린다. 명령(Command)과 조회(Query)를 분리하여 시스템의 복잡성을 줄일 수 있다.

<br /><br />

### # 이벤트 소싱의 단점

1. **복잡성 증가** : 이벤트 소싱은 기존 CRUD 방식에 비해 구현이 복잡할 수 있다. 이벤트의 정의, 저장, 재구성 등을 고려해야 하므로 초기 설계가 중요하다.

2. **이벤트 스토어 관리** : 이벤트 스토어의 크기가 커질 수 있으며, 이를 효율적으로 관리하는 방법이 필요하다. 이벤트의 수가 많아지면 성능 저하가 발생할 수 있다.

3. **이벤트 스키마 관리** : 이벤트의 구조가 변경될 경우, 기존 이벤트와의 호환성을 유지하는 것이 어려울 수 있다. 이벤트 버전 관리가 필요하다.

4. **이벤트 순서 보장** : 이벤트는 발생 순서대로 저장되어야 하며, 이를 보장하기 위한 추가적인 로직이 필요할 수 있다.

5. **읽기 성능 약화** : 이벤트 소싱은 이벤트 로그를 순차적으로 읽어야 하므로, 특정 상태를 조회하는 데 시간이 걸릴 수 있다. 이는 읽기 성능에 영향을 줄 수 있다.<br />
이는 중간 계산 결과를 따로 저장하는 스냅샷이라는 개념을 사용할 수 있지만, 전통적인 최종 상태를 저장하는 방식에 비해서는 읽기 성능이 떨어질 수 있다.

<br /><br />

### # 이벤트 소싱 사용 예시

- 어플리케이션 Object 상태 저장소 ( 상태 변화를 모두 저장해야하느 경우 )
- Audit 저장소 : 유저의 행위를 모두 기록하는 저장소
- Event Reversing & Replay가 필요한 경우 : Event의 재발행이 불가능한 시스템
- 재화 시스템을 만들 경우 해당 재화의 전체 흐름을 파악하기 위한 시스템 <br />
    ex) 미국의 Sarbanes–Oxley Act 법 대응 시스템

<br /><br />

참고 : 
- [이벤트 소싱이란 무엇인가요?](https://www.maeil-mail.kr/question/292)
- [이벤트 소싱(Event Sourcing) 개념](https://mjspring.medium.com/%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%86%8C%EC%8B%B1-event-sourcing-%EA%B0%9C%EB%85%90-50029f50f78c)
- [Event Sourcing 맛보기 - 이론편](https://sabarada.tistory.com/231)